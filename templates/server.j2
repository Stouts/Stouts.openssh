# This file was generated by Ansible for {{ ansible_fqdn }}
# Do NOT modify this file by hand!

# See the sshd_config(5) manpage for details

# What ports, IPs and protocols we listen for
Port {{ openssh_server_vars.Port|default(openssh_server_defaults.Port) }}

{% if openssh_server_vars.AllowUsers|default(openssh_server_defaults.AllowUsers) %}
# Allow users to login
AllowUsers {{ openssh_server_vars.AllowUsers|default(openssh_server_defaults.AllowUsers)|join(" ") }}
{% endif %}

{% if openssh_server_vars.AllowGroups|default(openssh_server_defaults.AllowGroups) %}
# Allow groups to login
AllowGroups {{ openssh_server_vars.AllowGroups|default(openssh_server_defaults.AllowGroups)|join(" ") }}
{% endif %}

# Use these options to restrict which interfaces/protocols sshd will bind to
{% for address in openssh_server_vars.ListenAddress|default(openssh_server_defaults.ListenAddress) %}
ListenAddress {{ address }}
{% endfor %}

Protocol {{ openssh_server_vars.Protocol|default(openssh_server_defaults.Protocol) }}

# HostKeys for protocol version 2
{% for hostkey in openssh_server_vars.HostKey|default(openssh_server_defaults.HostKey) %}
HostKey {{ hostkey }}
{% endfor %}

#Privilege Separation is turned on for security
UsePrivilegeSeparation {{ 'yes' if openssh_server_vars.UserPrivilegeSeparation|default(openssh_server_defaults.UserPrivilegeSeparation) else 'no' }}

# Lifetime and size of ephemeral version 1 server key
KeyRegenerationInterval {{ openssh_server_vars.KeyRegenerationInterval|default(openssh_server_defaults.KeyRegenerationInterval) }}
ServerKeyBits {{ openssh_server_vars.ServerKeyBits|default(openssh_server_defaults.ServerKeyBits) }}

# Logging
SyslogFacility {{ openssh_server_vars.SyslogFacility|default(openssh_server_defaults.SyslogFacility) }}
LogLevel {{ openssh_server_vars.LogLevel|default(openssh_server_defaults.LogLevel) }}

# Authentication:
LoginGraceTime {{ openssh_server_vars.LoginGraceTime|default(openssh_server_defaults.LoginGraceTime) }}
PermitRootLogin {{ 'yes' if openssh_server_vars.PermitRootLogin|default(openssh_server_defaults.PermitRootLogin) else 'no' }}
StrictModes {{ 'yes' if openssh_server_vars.StrictModes|default(openssh_server_defaults.StrictModes) else 'no' }}
RSAAuthentication {{ 'yes' if openssh_server_vars.RSAAuthentication|default(openssh_server_defaults.RSAAuthentication) else 'no' }}
PubkeyAuthentication {{ 'yes' if openssh_server_vars.PubkeyAuthentication|default(openssh_server_defaults.PubkeyAuthentication) else 'no' }}

#AuthorizedKeysFile     %h/.ssh/authorized_keys

# Don't read the user's ~/.rhosts and ~/.shosts files
IgnoreRhosts {{ 'yes' if openssh_server_vars.IgnoreRhost|default(openssh_server_defaults.IgnoreRhost) else 'no' }}

# For this to work you will also need host keys in /etc/ssh_known_hosts
RhostsRSAAuthentication {{ 'yes' if openssh_server_vars.RhostsRSAAuthentication|default(openssh_server_defaults.RhostsRSAAuthentication) else 'no' }}

# similar for protocol version 2
HostbasedAuthentication {{ 'yes' if openssh_server_vars.HostbasedAuthentication|default(openssh_server_defaults.HostbasedAuthentication) else 'no' }}

# Uncomment if you don't trust ~/.ssh/known_hosts for RhostsRSAAuthentication
IgnoreUserKnownHosts {{ 'yes' if openssh_server_vars.IgnoreUserKnownHosts|default(openssh_server_defaults.IgnoreUserKnownHosts) else 'no' }}

# To enable empty passwords, change to yes (NOT RECOMMENDED)
PermitEmptyPasswords {{ 'yes' if openssh_server_vars.PermitEmptyPasswords|default(openssh_server_defaults.PermitEmptyPasswords) else 'no' }}

# Change to yes to enable challenge-response passwords (beware issues with
# some PAM modules and threads)
ChallengeResponseAuthentication {{ 'yes' if openssh_server_vars.ChallengeResponseAuthentication|default(openssh_server_defaults.ChallengeResponseAuthentication) else 'no' }}

# Change to no to disable tunnelled clear text passwords
PasswordAuthentication {{ 'yes' if openssh_server_vars.PasswordAuthentication|default(openssh_server_defaults.PasswordAuthentication) else 'no' }}

# Kerberos options
KerberosAuthentication {{ 'yes' if openssh_server_vars.KerberosAuthentication|default(openssh_server_defaults.KerberosAuthentication) else 'no' }}
KerberosOrLocalPasswd {{ 'yes' if openssh_server_vars.KerberosOrLocalPasswd|default(openssh_server_defaults.KerberosOrLocalPasswd) else 'no' }}
KerberosTicketCleanup {{ 'yes' if openssh_server_vars.KerberosTicketCleanup|default(openssh_server_defaults.KerberosTicketCleanup) else 'no' }}

# GSSAPI options
GSSAPIAuthentication {{ 'yes' if openssh_server_vars.GSSAPIAuthentication|default(openssh_server_defaults.GSSAPIAuthentication) else 'no' }}
GSSAPICleanupCredentials {{ 'yes' if openssh_server_vars.GSSAPICleanupCredentials|default(openssh_server_defaults.GSSAPICleanupCredentials) else 'no' }}

X11Forwarding {{ 'yes' if openssh_server_vars.X11Forwarding|default(openssh_server_defaults.X11Forwarding) else 'no' }}
X11DisplayOffset {{ openssh_server_vars.X11DisplayOffset|default(openssh_server_defaults.X11DisplayOffset) }}
PrintMotd {{ 'yes' if openssh_server_vars.PrintMotd|default(openssh_server_defaults.PrintMotd) else 'no' }}
PrintLastLog {{ 'yes' if openssh_server_vars.PrintLastLog|default(openssh_server_defaults.PrintLastLog) else 'no' }}
TCPKeepAlive {{ 'yes' if openssh_server_vars.TCPKeepAlive|default(openssh_server_defaults.TCPKeepAlive) else 'no' }}
UseLogin {{ 'yes' if openssh_server_vars.UseLogin|default(openssh_server_defaults.UseLogin) else 'no' }}

MaxStartups {{ openssh_server_vars.MaxStartups|default(openssh_server_defaults.MaxStartups) }}
Banner {{ openssh_server_vars.Banner|default(openssh_server_defaults.Banner) }}

# Allow client to pass locale environment variables
AcceptEnv {{ openssh_server_vars.AcceptEnv|default(openssh_server_defaults.AcceptEnv) }}
Subsystem {{ openssh_server_vars.Subsystem|default(openssh_server_defaults.Subsystem) }}

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the ChallengeResponseAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via ChallengeResponseAuthentication may bypass
# the setting of "PermitRootLogin without-password".
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and ChallengeResponseAuthentication to 'no'.
UsePAM {{ 'yes' if openssh_server_vars.UsePAM|default(openssh_server_defaults.UsePAM) else 'no' }}
UseDNS {{ 'yes' if openssh_server_vars.UseDNS|default(openssh_server_defaults.UseDNS) else 'no' }}

# Additional options
{% for name, value in openssh_server_vars.items() %}
{% if not name in openssh_server_defaults %}
{{ name }} {{ value }}
{% endif %}
{% endfor %}
